----- Fold 1 -----
2025-08-02 11:18:11.058915: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754133491.080860      95 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754133491.087483      95 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
Some weights of XLMRobertaModel were not initialized from the model checkpoint at /kaggle/input/xlm-roberta-base-offline/xlm_roberta_base_offline and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Training Epoch 1: 100%|██████████| 203/203 [01:40<00:00,  2.03it/s]
Epoch 1 Loss: 0.6874
Validating Epoch 1: 100%|██████████| 51/51 [00:06<00:00,  7.54it/s]
              precision    recall  f1-score   support

         0.0      0.769     0.050     0.094       200
         1.0      0.517     0.985     0.678       206

    accuracy                          0.525       406
   macro avg      0.643     0.518     0.386       406
weighted avg      0.641     0.525     0.390       406

AUC Score: 0.5428
  -> New best Val AUC for Fold 1: 0.5428
Training Epoch 2: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 2 Loss: 0.6324
Validating Epoch 2: 100%|██████████| 51/51 [00:06<00:00,  7.54it/s]
              precision    recall  f1-score   support

         0.0      0.938     0.375     0.536       200
         1.0      0.617     0.976     0.756       206

    accuracy                          0.680       406
   macro avg      0.777     0.675     0.646       406
weighted avg      0.775     0.680     0.647       406

AUC Score: 0.8108
  -> New best Val AUC for Fold 1: 0.8108
Training Epoch 3: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 3 Loss: 0.5168
Validating Epoch 3: 100%|██████████| 51/51 [00:06<00:00,  7.51it/s]
              precision    recall  f1-score   support

         0.0      0.917     0.610     0.733       200
         1.0      0.714     0.947     0.814       206

    accuracy                          0.781       406
   macro avg      0.816     0.778     0.773       406
weighted avg      0.814     0.781     0.774       406

AUC Score: 0.8418
  -> New best Val AUC for Fold 1: 0.8418
Training Epoch 4: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 4 Loss: 0.4383
Validating Epoch 4: 100%|██████████| 51/51 [00:06<00:00,  7.52it/s]
              precision    recall  f1-score   support

         0.0      0.825     0.755     0.789       200
         1.0      0.780     0.845     0.811       206

    accuracy                          0.800       406
   macro avg      0.803     0.800     0.800       406
weighted avg      0.802     0.800     0.800       406

AUC Score: 0.8590
  -> New best Val AUC for Fold 1: 0.8590
Training Epoch 5: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 5 Loss: 0.3543
Validating Epoch 5: 100%|██████████| 51/51 [00:06<00:00,  7.51it/s]
              precision    recall  f1-score   support

         0.0      0.897     0.650     0.754       200
         1.0      0.732     0.927     0.818       206

    accuracy                          0.791       406
   macro avg      0.814     0.789     0.786       406
weighted avg      0.813     0.791     0.786       406

AUC Score: 0.8558
Training Epoch 6: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 6 Loss: 0.2750
Validating Epoch 6: 100%|██████████| 51/51 [00:06<00:00,  7.53it/s]
              precision    recall  f1-score   support

         0.0      0.800     0.760     0.779       200
         1.0      0.778     0.816     0.796       206

    accuracy                          0.788       406
   macro avg      0.789     0.788     0.788       406
weighted avg      0.789     0.788     0.788       406

AUC Score: 0.8559
Fold 1 Best Val AUC: 0.8590
Fold 1 OOF Prediction: 100%|██████████| 51/51 [00:06<00:00,  7.54it/s]
Fold 1 OOF AUC Check: 0.8559 (Must match Best Val AUC)
Fold 1 Test Prediction: 100%|██████████| 1/1 [00:00<00:00,  6.06it/s]

----- Fold 2 -----
Some weights of XLMRobertaModel were not initialized from the model checkpoint at /kaggle/input/xlm-roberta-base-offline/xlm_roberta_base_offline and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Training Epoch 1: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 1 Loss: 0.6833
Validating Epoch 1: 100%|██████████| 51/51 [00:06<00:00,  7.55it/s]
              precision    recall  f1-score   support

         0.0      0.612     0.505     0.553       200
         1.0      0.589     0.689     0.635       206

    accuracy                          0.599       406
   macro avg      0.601     0.597     0.594       406
weighted avg      0.600     0.599     0.595       406

AUC Score: 0.7007
  -> New best Val AUC for Fold 2: 0.7007
Training Epoch 2: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 2 Loss: 0.5634
Validating Epoch 2: 100%|██████████| 51/51 [00:06<00:00,  7.52it/s]
              precision    recall  f1-score   support

         0.0      0.800     0.680     0.735       200
         1.0      0.729     0.835     0.778       206

    accuracy                          0.759       406
   macro avg      0.764     0.757     0.757       406
weighted avg      0.764     0.759     0.757       406

AUC Score: 0.7919
  -> New best Val AUC for Fold 2: 0.7919
Training Epoch 3: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 3 Loss: 0.4721
Validating Epoch 3: 100%|██████████| 51/51 [00:06<00:00,  7.54it/s]
              precision    recall  f1-score   support

         0.0      0.854     0.700     0.769       200
         1.0      0.752     0.883     0.813       206

    accuracy                          0.793       406
   macro avg      0.803     0.792     0.791       406
weighted avg      0.802     0.793     0.791       406

AUC Score: 0.8296
  -> New best Val AUC for Fold 2: 0.8296
Training Epoch 4: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 4 Loss: 0.3680
Validating Epoch 4: 100%|██████████| 51/51 [00:06<00:00,  7.53it/s]
              precision    recall  f1-score   support

         0.0      0.838     0.750     0.792       200
         1.0      0.780     0.859     0.818       206

    accuracy                          0.805       406
   macro avg      0.809     0.805     0.805       406
weighted avg      0.808     0.805     0.805       406

AUC Score: 0.8582
  -> New best Val AUC for Fold 2: 0.8582
Training Epoch 5: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 5 Loss: 0.3071
Validating Epoch 5: 100%|██████████| 51/51 [00:06<00:00,  7.54it/s]
              precision    recall  f1-score   support

         0.0      0.787     0.775     0.781       200
         1.0      0.785     0.796     0.790       206

    accuracy                          0.786       406
   macro avg      0.786     0.786     0.786       406
weighted avg      0.786     0.786     0.786       406

AUC Score: 0.8709
  -> New best Val AUC for Fold 2: 0.8709
Training Epoch 6: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 6 Loss: 0.2446
Validating Epoch 6: 100%|██████████| 51/51 [00:06<00:00,  7.54it/s]
              precision    recall  f1-score   support

         0.0      0.839     0.705     0.766       200
         1.0      0.752     0.869     0.806       206

    accuracy                          0.788       406
   macro avg      0.796     0.787     0.786       406
weighted avg      0.795     0.788     0.787       406

AUC Score: 0.8634
Fold 2 Best Val AUC: 0.8709
Fold 2 OOF Prediction: 100%|██████████| 51/51 [00:06<00:00,  7.55it/s]
Fold 2 OOF AUC Check: 0.8634 (Must match Best Val AUC)
Fold 2 Test Prediction: 100%|██████████| 1/1 [00:00<00:00,  6.07it/s]

----- Fold 3 -----
Some weights of XLMRobertaModel were not initialized from the model checkpoint at /kaggle/input/xlm-roberta-base-offline/xlm_roberta_base_offline and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Training Epoch 1: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 1 Loss: 0.6769
Validating Epoch 1: 100%|██████████| 51/51 [00:06<00:00,  7.53it/s]
              precision    recall  f1-score   support

         0.0      0.807     0.335     0.473       200
         1.0      0.588     0.922     0.718       206

    accuracy                          0.633       406
   macro avg      0.698     0.629     0.596       406
weighted avg      0.696     0.633     0.598       406

AUC Score: 0.6514
  -> New best Val AUC for Fold 3: 0.6514
Training Epoch 2: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 2 Loss: 0.6227
Validating Epoch 2: 100%|██████████| 51/51 [00:06<00:00,  7.52it/s]
              precision    recall  f1-score   support

         0.0      0.798     0.750     0.773       200
         1.0      0.771     0.816     0.792       206

    accuracy                          0.783       406
   macro avg      0.784     0.783     0.783       406
weighted avg      0.784     0.783     0.783       406

AUC Score: 0.8292
  -> New best Val AUC for Fold 3: 0.8292
Training Epoch 3: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 3 Loss: 0.5114
Validating Epoch 3: 100%|██████████| 51/51 [00:06<00:00,  7.54it/s]
              precision    recall  f1-score   support

         0.0      0.831     0.760     0.794       200
         1.0      0.785     0.850     0.816       206

    accuracy                          0.805       406
   macro avg      0.808     0.805     0.805       406
weighted avg      0.807     0.805     0.805       406

AUC Score: 0.8781
  -> New best Val AUC for Fold 3: 0.8781
Training Epoch 4: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 4 Loss: 0.4143
Validating Epoch 4: 100%|██████████| 51/51 [00:06<00:00,  7.54it/s]
              precision    recall  f1-score   support

         0.0      0.821     0.690     0.750       200
         1.0      0.739     0.854     0.793       206

    accuracy                          0.773       406
   macro avg      0.780     0.772     0.771       406
weighted avg      0.780     0.773     0.772       406

AUC Score: 0.8604
Training Epoch 5: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 5 Loss: 0.3458
Validating Epoch 5: 100%|██████████| 51/51 [00:06<00:00,  7.57it/s]
              precision    recall  f1-score   support

         0.0      0.848     0.640     0.729       200
         1.0      0.718     0.888     0.794       206

    accuracy                          0.766       406
   macro avg      0.783     0.764     0.762       406
weighted avg      0.782     0.766     0.762       406

AUC Score: 0.8536
Training Epoch 6: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 6 Loss: 0.2836
Validating Epoch 6: 100%|██████████| 51/51 [00:06<00:00,  7.56it/s]
              precision    recall  f1-score   support

         0.0      0.767     0.740     0.753       200
         1.0      0.756     0.782     0.768       206

    accuracy                          0.761       406
   macro avg      0.761     0.761     0.761       406
weighted avg      0.761     0.761     0.761       406

AUC Score: 0.8594
Fold 3 Best Val AUC: 0.8781
Fold 3 OOF Prediction: 100%|██████████| 51/51 [00:06<00:00,  7.55it/s]
Fold 3 OOF AUC Check: 0.8594 (Must match Best Val AUC)
Fold 3 Test Prediction: 100%|██████████| 1/1 [00:00<00:00,  6.08it/s]

----- Fold 4 -----
Some weights of XLMRobertaModel were not initialized from the model checkpoint at /kaggle/input/xlm-roberta-base-offline/xlm_roberta_base_offline and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Training Epoch 1: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 1 Loss: 0.6839
Validating Epoch 1: 100%|██████████| 51/51 [00:06<00:00,  7.56it/s]
              precision    recall  f1-score   support

         0.0      0.662     0.658     0.660       199
         1.0      0.673     0.676     0.675       207

    accuracy                          0.667       406
   macro avg      0.667     0.667     0.667       406
weighted avg      0.667     0.667     0.667       406

AUC Score: 0.7522
  -> New best Val AUC for Fold 4: 0.7522
Training Epoch 2: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 2 Loss: 0.5868
Validating Epoch 2: 100%|██████████| 51/51 [00:06<00:00,  7.56it/s]
              precision    recall  f1-score   support

         0.0      0.846     0.663     0.744       199
         1.0      0.732     0.884     0.801       207

    accuracy                          0.776       406
   macro avg      0.789     0.774     0.772       406
weighted avg      0.788     0.776     0.773       406

AUC Score: 0.8666
  -> New best Val AUC for Fold 4: 0.8666
Training Epoch 3: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 3 Loss: 0.4577
Validating Epoch 3: 100%|██████████| 51/51 [00:06<00:00,  7.56it/s]
              precision    recall  f1-score   support

         0.0      0.850     0.683     0.758       199
         1.0      0.744     0.884     0.808       207

    accuracy                          0.786       406
   macro avg      0.797     0.784     0.783       406
weighted avg      0.796     0.786     0.783       406

AUC Score: 0.8686
  -> New best Val AUC for Fold 4: 0.8686
Training Epoch 4: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 4 Loss: 0.3608
Validating Epoch 4: 100%|██████████| 51/51 [00:06<00:00,  7.50it/s]
              precision    recall  f1-score   support

         0.0      0.864     0.543     0.667       199
         1.0      0.676     0.918     0.779       207

    accuracy                          0.734       406
   macro avg      0.770     0.730     0.723       406
weighted avg      0.768     0.734     0.724       406

AUC Score: 0.8309
Training Epoch 5: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 5 Loss: 0.3017
Validating Epoch 5: 100%|██████████| 51/51 [00:06<00:00,  7.51it/s]
              precision    recall  f1-score   support

         0.0      0.836     0.638     0.724       199
         1.0      0.717     0.879     0.790       207

    accuracy                          0.761       406
   macro avg      0.776     0.759     0.757       406
weighted avg      0.775     0.761     0.757       406

AUC Score: 0.8606
Training Epoch 6: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 6 Loss: 0.2614
Validating Epoch 6: 100%|██████████| 51/51 [00:06<00:00,  7.56it/s]
              precision    recall  f1-score   support

         0.0      0.849     0.593     0.698       199
         1.0      0.697     0.899     0.785       207

    accuracy                          0.749       406
   macro avg      0.773     0.746     0.742       406
weighted avg      0.771     0.749     0.742       406

AUC Score: 0.8423
Fold 4 Best Val AUC: 0.8686
Fold 4 OOF Prediction: 100%|██████████| 51/51 [00:06<00:00,  7.56it/s]
Fold 4 OOF AUC Check: 0.8423 (Must match Best Val AUC)
Fold 4 Test Prediction: 100%|██████████| 1/1 [00:00<00:00,  6.08it/s]

----- Fold 5 -----
Some weights of XLMRobertaModel were not initialized from the model checkpoint at /kaggle/input/xlm-roberta-base-offline/xlm_roberta_base_offline and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Training Epoch 1: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 1 Loss: 0.6881
Validating Epoch 1: 100%|██████████| 51/51 [00:06<00:00,  7.55it/s]
              precision    recall  f1-score   support

         0.0      0.912     0.312     0.464       199
         1.0      0.593     0.971     0.737       206

    accuracy                          0.647       405
   macro avg      0.753     0.641     0.601       405
weighted avg      0.750     0.647     0.603       405

AUC Score: 0.6998
  -> New best Val AUC for Fold 5: 0.6998
Training Epoch 2: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 2 Loss: 0.6019
Validating Epoch 2: 100%|██████████| 51/51 [00:06<00:00,  7.57it/s]
              precision    recall  f1-score   support

         0.0      0.757     0.704     0.729       199
         1.0      0.732     0.782     0.756       206

    accuracy                          0.743       405
   macro avg      0.744     0.743     0.743       405
weighted avg      0.744     0.743     0.743       405

AUC Score: 0.7893
  -> New best Val AUC for Fold 5: 0.7893
Training Epoch 3: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 3 Loss: 0.5026
Validating Epoch 3: 100%|██████████| 51/51 [00:06<00:00,  7.57it/s]
              precision    recall  f1-score   support

         0.0      0.787     0.724     0.754       199
         1.0      0.752     0.811     0.780       206

    accuracy                          0.768       405
   macro avg      0.770     0.767     0.767       405
weighted avg      0.769     0.768     0.767       405

AUC Score: 0.8491
  -> New best Val AUC for Fold 5: 0.8491
Training Epoch 4: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 4 Loss: 0.4303
Validating Epoch 4: 100%|██████████| 51/51 [00:06<00:00,  7.57it/s]
              precision    recall  f1-score   support

         0.0      0.826     0.668     0.739       199
         1.0      0.730     0.864     0.791       206

    accuracy                          0.768       405
   macro avg      0.778     0.766     0.765       405
weighted avg      0.777     0.768     0.765       405

AUC Score: 0.8433
Training Epoch 5: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 5 Loss: 0.3566
Validating Epoch 5: 100%|██████████| 51/51 [00:06<00:00,  7.57it/s]
              precision    recall  f1-score   support

         0.0      0.810     0.643     0.717       199
         1.0      0.713     0.854     0.777       206

    accuracy                          0.751       405
   macro avg      0.761     0.749     0.747       405
weighted avg      0.760     0.751     0.748       405

AUC Score: 0.8635
  -> New best Val AUC for Fold 5: 0.8635
Training Epoch 6: 100%|██████████| 203/203 [01:39<00:00,  2.04it/s]
Epoch 6 Loss: 0.3111
Validating Epoch 6: 100%|██████████| 51/51 [00:06<00:00,  7.58it/s]
              precision    recall  f1-score   support

         0.0      0.799     0.719     0.757       199
         1.0      0.752     0.825     0.787       206

    accuracy                          0.773       405
   macro avg      0.776     0.772     0.772       405
weighted avg      0.775     0.773     0.772       405

AUC Score: 0.8628
Fold 5 Best Val AUC: 0.8635
Fold 5 OOF Prediction: 100%|██████████| 51/51 [00:06<00:00,  7.57it/s]
Fold 5 OOF AUC Check: 0.8628 (Must match Best Val AUC)
Fold 5 Test Prediction: 100%|██████████| 1/1 [00:00<00:00,  6.09it/s]

--- Overall 5-Fold OOF AUC: 0.8523 ---
K-Fold multi-input submission.csv created successfully!
   row_id  rule_violation
0    2029        0.032626
1    2030        0.618280
2    2031        0.918273
3    2032        0.980104
4    2033        0.969868
5    2034        0.018413
6    2035        0.966329
7    2036        0.020938
8    2037        0.019040
9    2038        0.955069